{% extends "layout.html" %}
{% block body %}
<body>
<h1>Index</h1>
<p>Message: <input id="in" /></p>
<pre id="out"></pre>
<script>
    function sse() {
        var source = new EventSource('/stream');
        source.onmessage = function(e) {
            $('#out').html(e.data + $('#out').html());
        };
    }
    $('#in').keyup(function(e){
        if (e.keyCode == 13) {
            $.post('/post', {'message': $(this).val()});
            $(this).val('');
        }
    });
    sse();
</script>

</body>
{% endblock %}